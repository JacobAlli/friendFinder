<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>friendFinder</title>
     <link rel="stylesheet" href="semantic/dist/semantic.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
    <script src="semantic/dist/semantic.min.js"></script>
    <style>
        .center {
            text-align: center;
        }

        .big-font {
            font-size: 26px;
        }


    </style>
</head>
<body>

          <div class="ui modal match">
  <i class="close icon"></i>
  <div class="header modal-header">
    blah
  </div>
  <div class="image content">
    <div class="ui medium image">
      <img src="" alt="Picture of Friend">
    </div>
    <div class="description big-font">
      <div class="ui header desc-header"></div>
    </div>
  </div>
  <div class="actions">
    <div class="ui black deny button">
      Nope
    </div>
    <div class="ui positive right labeled icon button">
      OOOOOOOHH LALA!
      <i class="checkmark icon"></i>
    </div>
  </div>
</div>

    <div class="ui text container center">
        <div class="ui divider"></div>

        <h1 class="ui dividing header">Survey Questions</h1>

        <h3 class="ui dividing header">About You</h3>

        <form action="/api/friends" class="ui form" method="POST">
            <div class="field">
              <label class="ui label fluid" for="name">Name</label>
              <input id="name" name="name" class="ui input fluid" type="text" placehodler="Name...">
            </div>

            <div class="ui divider"></div>

            <div class="field">
            <label class="ui label fluid" for="pic">Picture Link</label>
            <input id="pic" name="pic" class="ui input fluid" type="text" placehodler="www.myphoto.com">
            </div>

            <div class="ui divider"></div>
<div class="field">
            <label class="ui label fluid" for="q1">Your mind is always buzzing with unexplored ideas and plans.</label>
            <select id="q1" name="q1" class="ui dropdown">
                <option value="">Scale from 1 to 5</option>
                <option value="1">1</option>
                <option value="2">2</option>
                 <option value="3">3</option>
                  <option value="4">4</option>
                   <option value="5">5</option>
            </select>
</div>

<div class="ui divider"></div>
<div class="field">
            <label class="ui label fluid" for="q2">Generally speaking, you rely more on your experience than your imagination.</label>
            <select id="q2" name="q2" class="ui dropdown">
                <option value="">Scale from 1 to 5</option>
                <option value="1">1</option>
                <option value="2">2</option>
                 <option value="3">3</option>
                  <option value="4">4</option>
                   <option value="5">5</option>
            </select>
</div>

<div class="ui divider"></div>
<div class="field">
            <label class="ui label fluid" for="q3">You find it easy to stay relaxed and focused even when there is some pressure.</label>
            <select id="q3" name="q3" class="ui dropdown">
                <option value="">Scale from 1 to 5</option>
                <option value="1">1</option>
                <option value="2">2</option>
                 <option value="3">3</option>
                  <option value="4">4</option>
                   <option value="5">5</option>
            </select>
</div>

<div class="ui divider"></div>
<div class="field">
            <label class="ui label fluid" for="q4">You rarely do something just out of sheer curiosity.</label>
            <select id="q4" name="q4" class="ui dropdown">
                <option value="">Scale from 1 to 5</option>
                <option value="1">1</option>
                <option value="2">2</option>
                 <option value="3">3</option>
                  <option value="4">4</option>
                   <option value="5">5</option>
            </select>
            </div>


<div class="ui divider"></div>
<div class="field">
            <label class="ui label fluid" for="q5">People can rarely upset you.</label>
            <select id="q5" name="q5" class="ui dropdown">
                <option value="">Scale from 1 to 5</option>
                <option value="1">1</option>
                <option value="2">2</option>
                 <option value="3">3</option>
                  <option value="4">4</option>
                   <option value="5">5</option>
            </select>
            </div>


<div class="ui divider"></div>
<div class="field">
            <label class="ui label fluid" for="q6">It is often difficult for you to relate to other people’s feelings.</label>
            <select id="q6" name="q6" class="ui dropdown">
                <option value="">Scale from 1 to 5</option>
                <option value="1">1</option>
                <option value="2">2</option>
                 <option value="3">3</option>
                  <option value="4">4</option>
                   <option value="5">5</option>
            </select>
            </div>


<div class="ui divider"></div>
<div class="field">
            <label class="ui label fluid" for="q7">In a discussion, truth should be more important than people’s sensitivities..</label>
            <select id="q7" name="q7" class="ui dropdown">
                <option value="">Scale from 1 to 5</option>
                <option value="1">1</option>
                <option value="2">2</option>
                 <option value="3">3</option>
                  <option value="4">4</option>
                   <option value="5">5</option>
            </select>
            </div>


<div class="ui divider"></div>
            <div class="field">
            <label class="ui label fluid" for="q8">You rarely get carried away by fantasies and ideas.</label>
            <select id="q8" name="q8" class="ui dropdown">
                <option value="">Scale from 1 to 5</option>
                <option value="1">1</option>
                <option value="2">2</option>
                 <option value="3">3</option>
                  <option value="4">4</option>
                   <option value="5">5</option>
            </select>
            </div>


<div class="ui divider"></div>
<div class="field">
            <label class="ui label fluid" for="q9">You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</label>
            <select id="q9" name="q9" class="ui dropdown">
                <option value="">Scale from 1 to 5</option>
                <option value="1">1</option>
                <option value="2">2</option>
                 <option value="3">3</option>
                  <option value="4">4</option>
                   <option value="5">5</option>
            </select>
            </div>


<div class="ui divider"></div>
            <div class='field'>
            <label class="ui label fluid" for="q10">You feel more energetic after spending time with a group of people.</label>
            <select id="q10" name="q10" class="ui dropdown">
                <option value="">Scale from 1 to 5</option>
                <option value="1">1</option>
                <option value="2">2</option>
                 <option value="3">3</option>
                  <option value="4">4</option>
                   <option value="5">5</option>
            </select>
            </div>

<div class="ui divider"></div>

            <div class="ui error message"><ul class="list"></ul></div>
            <input type="submit" id="form-submit-btn" class="ui button teal fluid"></input>

        </form>



    </div>

    <script>

      var $form = $('.ui.form');

      var allFields = $form.form('get values');

      var allFieldsValues = Object.entries(allFields);





      $('.ui.form')
      .form({
        fields: {
          name     : 'empty',
          pic     : 'empty',
          q1: 'empty',
          q2: 'empty',
          q3: 'empty',
          q4: 'empty',
          q5: 'empty',
          q6: 'empty',
          q7: 'empty',
          q8: 'empty',
          q9: 'empty',
          q10: 'empty'
        }
      });


        $("#form-submit-btn").on('click', function(e){

            e.preventDefault();

            var formComplete;

            for(i=0; i<allFieldsValues.length; i++){
              if(allFieldsValues[i][1] === ""){
                formComplete = false;
                console.log(formComplete);
              }
            };

            if(formComplete){

              $.ajax({
                  method: 'get',
                  url: '/api/friends',
                  success: alertBestMatch,
              });
            };

        });

        function alertBestMatch(data){
            var answers = [];
            for(var i=1; i<11; i++){
                var questionNumber = JSON.stringify(i);
                answers.push($('#q'+questionNumber).val());
            };

            console.log(JSON.stringify(data));
            var friends = data;
            var bestMatch = null;
            var bestMatchName = null;
            var bestMatchPic;
            if(friends[0] === undefined){
                alert("Looks like you're the only one here... forever alone! :D");
            }
            else{
                for(var index in friends){

                    var currentFriend = friends[index];
                    var currentFriendAnswerTotal = 0;
                    console.log(currentFriend.length);
                    for(var i=1; i<11; i++){
                        currentFriendAnswerTotal += parseInt(currentFriend['q'+JSON.stringify(i)]);
                        console.log("friend question value" + i+ "\s"+currentFriend['q'+JSON.stringify(i)]);
                    }

                    console.log("friend ans:" + currentFriendAnswerTotal);
                    var answersTotal = 0;
                    for(var j in answers){
                        answersTotal += parseInt(answers[j]);

                    }

                    console.log("answerTot: " + answersTotal);
                    if(bestMatch === null){
                        bestMatch = Math.abs(answersTotal - currentFriendAnswerTotal);
                        bestMatchName = friends[index].name;
                        bestMatchPic = friends[index].pic;
                    }
                    else if(Math.abs(answersTotal- currentFriendAnswerTotal) === bestMatch){
                        bestMatchName += (" " + "or " + friends[index].name);
                    }
                    else if (Math.abs(answersTotal-currentFriendAnswerTotal) < bestMatch){
                        bestMatch = Math.abs(answersTotal - currentFriendAnswerTotal);
                        bestMatchName = friends[index].name;
                        bestMatchPic = friends[index].pic;
                    }
                }
                $('div.header.modal-header').html(bestMatchName);
                $('div.desc-header').html('Congrats you matched with '+ bestMatchName);
                $('img').attr('src', bestMatchPic);
                $('.match').modal('show');
                $('input#name').val("");
                $('input#pic').val("");
                $('select') .val("");

            }


        };



    </script>

</body>
</html>

